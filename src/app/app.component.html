<form id="language-creator" *ngIf="showLanguageCreator == true" [formGroup]="formLanguage" (ngSubmit)="createNewLanguage()"
  [@collapse]>
  <div class="row inner-spacer center-items">
    <div class="grow primary">Create Language</div>
    <button type="button" class="icon" (click)="showLanguageCreator = false">
      <i class="material-icons">close</i>
    </button>
  </div>
  <div class="col spacer">
    <input type="text" formControlName="name" placeholder="Name (eg: English)" autocomplete="off">
    <ng-container *ngIf="formLanguage.controls['name'].errors != null">
      <div class="error" *ngIf="formLanguage.controls['name'].errors['required']" [@collapse]>Required</div>
      <div class="error" *ngIf="formLanguage.controls['name'].errors['forbiddenName']" [@collapse]>Exists already</div>
    </ng-container>
    <input type="text" formControlName="nameFile" placeholder="File's name (eg: en)" autocomplete="off">
    <div *ngIf="formLanguage.controls['nameFile'].pristine && formLanguage.controls['name'].value.length > 0" [@collapse]>Default
      value will be used: {{formLanguage.controls['name'].value}}.json</div>
    <div>
      <button class="button row center-items" [disabled]="formLanguage.invalid">
        <i class="material-icons">add</i>
        <span>create new language</span>
      </button>
    </div>
  </div>
</form>

<div id="wrapper-tabs" class="row overflow">
  <div class="row inner-spacer center-items" [class.selected]="language == selectedLanguage" [class.clickable]="selectedLanguage != language"
    *ngFor="let language of languages" (click)="selectedLanguage = language">
    <div *ngIf="language != baseLanguage" class="status" [class.success]="language == baseLanguage || language.errorCount == 0"
      [class.error]="language.errorCount > 0"></div>
    <span>{{language.name}}</span>
    <ng-container *ngIf="language == baseLanguage">*</ng-container>
  </div>
  <i class="material-icons clickable" *ngIf="showLanguageCreator == false" (click)="showLanguageCreator = true" [@collapse]>add</i>
</div>

<div id="content" class="col inner-spacer">
  <div class="row inner-spacer center-items">
    <button class="outline row inner-spacer center-items" (click)="uploader.click()">
      <span>import json</span>
    </button>
    <button class="outline row inner-spacer center-items" (click)="downloadJson()">
      <span>download json</span>
    </button>
    <button class="outline row inner-spacer center-items" (click)="deleteLanguage()">
      <i class="material-icons">delete</i>
      <span>delete language</span>
    </button>
    <button *ngIf="selectedLanguage != baseLanguage" class="outline row inner-spacer center-items" (click)="setBaseLanguage()">
      <i class="material-icons">star</i>
      <span>set as base language</span>
    </button>
  </div>
  <app-kop [kop]="selectedLanguage.kop" [language]="selectedLanguage.name" [isBaseLanguage]="selectedLanguage == baseLanguage">Root</app-kop>
  <!--
  <pre>{{selectedLanguage.kop|json}}</pre>
  -->
</div>
<input #uploader type="file" (change)="onUpload($event)" hidden>